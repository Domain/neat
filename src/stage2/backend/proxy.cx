module backend.proxy;

class TestBranchRecord {
    void* ptr;
    this(void* ptr) { this.ptr = ptr; }
    void resolveThen(int target) {
        _testBranchRecord_resolveThen(this.ptr, target);
    }
    void resolveElse(int target) {
        _testBranchRecord_resolveElse(this.ptr, target);
    }
}

class BackendFunction {
    void* ptr;
    this(void* ptr) { this.ptr = ptr; }
    int arg(int index) {
        return _backendFunction_arg(this.ptr, index);
    }
    int intLiteral(int value) {
        return _backendFunction_intLiteral(this.ptr, value);
    }
    int call(void* ret, char[] name, int[] args) {
        return _backendFunction_call(this.ptr, ret, name, args.ptr, args.length);
    }
    void ret(int reg) {
        _backendFunction_ret(this.ptr, reg);
    }
    TestBranchRecord testBranch(int reg) {
        return new TestBranchRecord(_backendFunction_testBranch(this.ptr, reg));
    }
    int blockIndex()
    {
        return _backendFunction_blockIndex(this.ptr);
    }
}

class BackendModule {
    void* ptr;
    this(void* ptr) { this.ptr = ptr; }
    void* intType() {
        return _backendModule_intType(this.ptr);
    }
    BackendFunction define(void* ret, char[] name, void*[] args)
    {
        return new BackendFunction(_backendModule_define(this.ptr, name, ret, args.ptr, args.length));
    }
    void call(void* ret_ptr, char[] name, void*[] args)
    {
        _backendModule_call(this.ptr, ret_ptr, name, args.ptr, args.length);
    }
    void dump()
    {
        _backendModule_dump(this.ptr);
    }
}

class Backend {
    void* ptr;
    this() { this.ptr = _backend(); }
    BackendModule createModule() {
        return new BackendModule(_backend_createModule(this.ptr));
    }
}
