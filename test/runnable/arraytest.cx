module arraytest;

macro import cx.macros.assert;

void main() {
    int[] arr;
    assert(arr.length == 0);
    // arr = [2, 3];
    arr = new int[](0) ~ 2 ~ 3;
    assert(arr.length == 2);
    assert(arr[1] == 3);
    arr = arr ~ 4; // [2, 3, 4]
    assert(arr.length == 3);
    assert(arr[2] == 4);
    arr = arr ~ (new int[](0) ~ 5); // [2, 3, 4, 5]
    assert(arr.length == 4);
    assert(arr[3] == 5);
    assert(arr == [2, 3, 4, 5]);
    assert(arr[$ - 1] == 5);
    assert(arr[0 .. $ - 1] == [2, 3, 4]);
    assert(arr[1 .. 3] == [3, 4]);
    assert("Hello World"["Hello ".length .. "Hello World".length] == "World");
    int[] arr = [];

    {
        int count;
        int[] test() { count += 1; return [1, 2]; }
        assert(test()[$ - 1] == 2);
        assert(count == 1);
    }
}
